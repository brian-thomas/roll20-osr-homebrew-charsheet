<div class="sheet-flex sheet-bottom-padding">

  <div class="sheet-header-left sheet-thin-border">

    <div class="sheet-inline-flex sheet-bottom-padding">
      <span class="sheet-bold-font">Name:</span>
      <input type="text" class="sheet-align-left sheet-info-name-long" name="attr_character_name"/>
      <input type="checkbox" class="sheet-is_multiclass" name="attr_is_multiclass" value="1"/>
      <span class="ability-check-label">Multiclass</span>
    </div>

    <div class="sheet-inline-flex">
       <select class="sheet-info-name" name="attr_class">
         <option selected="selected" value="none">--</option>
         <option value="fighter">Fighter</option>
         <option value="cleric">Cleric</option>
         <option value="specialist">Specialist</option>
         <option value="wizard">Wizard</option>
       </select>
       <select class="sheet-info-name-sm" name="attr_level">
         <option value="0">0</option>
         <option selected="selected" value="1">1</option>
         <option value="2">2</option>
         <option value="3">3</option>
         <option value="4">4</option>
         <option value="5">5</option>
         <option value="6">6</option>
         <option value="7">7</option>
         <option value="8">8</option>
         <option value="9">9</option>
         <option value="10">10</option>
       </select>
       <input type="text" class="sheet-align-right sheet-info-name-med" name="attr_xp" value="0"/>
       <input type="checkbox" class="sheet-next-level-up" name="attr_next_level_up" value="0" hidden="true" checked="true"/>
       <input type="text" class="sheet-align-right inactive-color sheet-next-level-notify sheet-info-name-med" name="attr_next_level_xp" value="1" readonly="true"/>
     </div>

     <div class="sheet-inline-flex sheet-bottom-padding">
       <span class="sheet-info-name">Class</span>
       <span class="sheet-info-name-sm">Level</span>
       <span class="sheet-info-name-med">XP</span>
       <span class="sheet-info-name-med">Next Level XP</span>
     </div>

     <input type="checkbox" class="sheet-multiclass_enabled" name="attr_multiclass_enabled" value="1" hidden="true"/>
     <div class="section-multiclass">
       <div class="sheet-inline-flex">
         <select class="sheet-info-name" name="attr_class2">
           <option selected="selected" value="none">--</option>
           <option value="fighter">Fighter</option>
           <option value="cleric">Cleric</option>
           <option value="specialist">Specialist</option>
           <option value="wizard">Wizard</option>
         </select>
         <select class="sheet-info-name" name="attr_level2">
           <option value="0" selected="selected">--</option>
           <option value="1">1</option>
           <option value="2">2</option>
           <option value="3">3</option>
           <option value="4">4</option>
           <option value="5">5</option>
           <option value="6">6</option>
           <option value="7">7</option>
           <option value="8">8</option>
           <option value="9">9</option>
           <option value="10">10</option>
         </select>
       </div>
       <div class="sheet-inline-flex">
         <span class="sheet-info-name">Class</span>
         <span class="sheet-info-name">Level</span>
         <span class="sheet-info-name">&nbsp;</span>
       </div>
     </div>

      <div class="sheet-block">
         <div class="sheet-inline-flex">
           <select class="sheet-info-name" name="attr_alignment">
              <option selectekd="selected" value="Neutral">Neutral</option>
              <option value="Lawful">Lawful</option>
              <option value="Chaotic">Chaotic</option>
           </select>
           <select class="sheet-info-name" name="attr_race">
              <option selected="selected" value="Human">Human</option>
              <option value="Dwarf">Dwarf</option>
              <option value="Elven">Elven</option>
              <option value="Halfling">Halfling</option>
           </select>
           <input type="text" class="sheet-info-name" name="attr_background"/>
         </div>
         <div class="sheet-inline-flex">
           <span class="sheet-info-name">Alignment</span>
           <span class="sheet-info-name">Race</span>
           <span class="sheet-info-name">Background</span>
         </div>
      </div>

    </div>

    <div class="sheet-header-right sheet-noborder">
      <img src="https://raw.githubusercontent.com/brian-thomas/roll20-osr-homebrew-charsheet/master/osr_logo.png"
           class="sheet-logo">
    </div>

  </div>
</div>

<div class="sheet-inline">

  <input type="radio" name="attr_tab" class="sheet-tab sheet-tab1" value="1" checked="checked" />
  <span class="sheet-tab sheet-tab1">Core Stats</span>
  <input type="radio" name="attr_tab" class="sheet-tab sheet-tab2" value="2" />
  <span class="sheet-tab sheet-tab2">Combat</span>
  <input type="radio" name="attr_tab" class="sheet-tab sheet-tab3" value="3" />
  <span class="sheet-tab sheet-tab3">Magic</span>
  <input type="radio" name="attr_tab" class="sheet-tab sheet-tab4" value="4" />
  <span class="sheet-tab sheet-tab4">Inventory</span>
  <input type="radio" name="attr_tab" class="sheet-tab sheet-tab5" value="5" />
  <span class="sheet-tab sheet-tab5">Notes</span>
  <input type="radio" name="attr_tab" class="sheet-tab sheet-tab99" value="99" />
  <span class="sheet-tab sheet-tab99">Show All</span>

  <div class="section-core">
    <span class="sheet-spacer">&nbsp;</span>
    <div class="sheet-bottom-padding sheet-flex-between">
      <div class="sheet-col-left">
        <div class="sheet-flex-between">
          <div class="sheet-col-left-left sheet-thick-border">
            <h3>Abilities</h3>
            <div class="sheet-flex">
              <div class="sheet-ability-column-value">
                <span>Strength</span>
                <input class="ability-value" name="attr_strength" type="number" value="10"/>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input name="attr_strength_mod" type="number" value="0" class="sheet-ability-modifier inactive-color" readonly="true"/>
                <span class="noborder left-pad">Melee AB, Athletics, Open Doors, Encumbrance, Fortitude</span>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_str_check"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=STR Check}} {{subheader=@{character_name}}} {{ability=1}} {{simple=1}} {{math=roll: 1d20 + @{strength_mod} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{strength_mod}]] ]]}}"></button>
              </div>
            </div>

            <div class="sheet-flex">
              <div class="sheet-ability-column-value">
                <span>Dexterity</span>
                <input class="ability-value" name="attr_dexterity" type="number" value="10"/>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input name="attr_dexterity_mod" type="number" value="0" class="sheet-ability-modifier inactive-color" readonly="true"/>
                <span class="noborder left-pad">Ranged AB, Dodge, AC, Initiative, Stealth</span>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_dex_check"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=DEX Check}} {{subheader=@{character_name}}} {{ability=1}} {{simple=1}} {{math=roll: 1d20 + @{dexterity_mod} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{dexterity_mod}]] ]]}}"></button>
              </div>
            </div>

            <div class="sheet-flex">
              <div class="sheet-ability-column-value">
                <span>Constitution</span>
                <input class="ability-value" name="attr_constitution" type="number" value="10"/>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input name="attr_constitution_mod" type="number" value="0" class="sheet-ability-modifier inactive-color" readonly="true"/>
                <span class="noborder left-pad">Health, Hit Points</span>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_con_check"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=CON Check}} {{subheader=@{character_name}}} {{ability=1}} {{simple=1}} {{math=roll: 1d20 + @{constitution_mod} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{constitution_mod}]] ]]}}"></button>

              </div>
            </div>

            <div class="sheet-flex">
              <div class="sheet-ability-column-value">
                <span>Intelligence</span>
                <input class="ability-value" name="attr_intelligence" type="number" value="10"/>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input name="attr_intelligence_mod" type="number" value="0" class="sheet-ability-modifier inactive-color" readonly="true"/>
                <span class="noborder left-pad">Perception, Languages, Search, Magic Spell Casting, Skill Points</span>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_int_check"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=INT Check}} {{subheader=@{character_name}}} {{ability=1}} {{simple=1}} {{math=roll: 1d20 + @{intelligence_mod} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{intelligence_mod}]] ]]}}"></button>
              </div>
            </div>

            <div class="sheet-flex">
              <div class="sheet-ability-column-value">
                <span>Wisdom</span>
                <input class="ability-value" name="attr_wisdom" type="number" value="10"/>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input name="attr_wisdom_mod" type="number" value="0" class="sheet-ability-modifier inactive-color" readonly="true"/>
                <span class="noborder left-pad">Willpower, Cleric Powers</span>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_wis_check"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=WIS Check}} {{subheader=@{character_name}}} {{ability=1}} {{simple=1}} {{math=roll: 1d20 + @{wisdom_mod} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{wisdom_mod}]] ]]}}"></button>
              </div>
            </div>

            <div class="sheet-flex">
              <div class="sheet-ability-column-value">
                <span>Charisma</span>
                <input class="ability-value" name="attr_charisma" type="number" value="10"/>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input name="attr_charisma_mod" type="number" value="0" class="sheet-ability-modifier inactive-color" readonly="true"/>
                <span class="noborder left-pad">Retainer Recruitment, Loyalty, Reaction, Social Skill</span>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_cha_check"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=CHA Check}} {{subheader=@{character_name}}} {{ability=1}} {{simple=1}} {{math=roll: 1d20 + @{charisma_mod} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{charisma_mod}]] ]]}}"></button>
              </div>
            </div>
          </div>

          <div class="sheet-col-left-right sheet-save-col sheet-thick-border-no-pad">
            <h3>Checks</h3>
            <div class="sheet-flex-between">
              <div class="sheet-ability-column-value">
                <span class="ability-check-label">Fortitude</span>
                <input class="ability-check-value inactive-color" name="attr_fortitude" type="number" value="0" readonly="true"/>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_fortitude"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Fortitude Check}} {{subheader=@{character_name}}} {{save=1}} {{simple=1}} {{math=roll: 1d20 + @{fortitude} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{fortitude}]] ]]}}"></button>
                </button>
              </div>
            </div>
            <div class="sheet-flex-between">
              <div class="sheet-ability-column-value">
                <span class="ability-check-label">Dodge</span>
                <input class="ability-check-value inactive-color" name="attr_dodge" type="number" value="0" readonly="true"/>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_dodge"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Dodge Check}} {{subheader=@{character_name}}} {{save=1}} {{simple=1}} {{math=roll: 1d20 + @{dodge} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{dodge}]] ]]}}"></button>
                </button>
              </div>
            </div>

            <div class="sheet-flex-between">
              <div class="sheet-ability-column-value">
                <span class="ability-check-label">Health</span>
                <input class="ability-check-value inactive-color" name="attr_health" type="number" value="0" readonly="true"/>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_health"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Health Check}} {{subheader=@{character_name}}} {{save=1}} {{simple=1}} {{math=roll: 1d20 + @{health} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{health}]] ]]}}"></button>
                </button>
              </div>
            </div>

            <div class="sheet-flex-between">
              <div class="sheet-ability-column-value">
                <span class="ability-check-label">Perception</span>
                <input class="ability-check-value inactive-color" name="attr_perception" type="number" value="0" readonly="true"/>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_perception"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Perception Check}} {{subheader=@{character_name}}} {{save=1}} {{simple=1}} {{math=roll: 1d20 + @{perception} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{perception}]] ]]}}"></button>
                </button>
              </div>
            </div>

            <div class="sheet-flex-between">
              <div class="sheet-ability-column-value">
                <span class="ability-check-label">Willpower</span>
                <input class="ability-check-value inactive-color" name="attr_willpower" type="number" value="0" readonly="true"/>
              </div>
              <div class="sheet-ability-column-roll sheet-flex">
                <button class="sheet-ability-button" type="roll" name="roll_willpower"
                        value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Willpower Check}} {{subheader=@{character_name}}} {{save=1}} {{simple=1}} {{math=roll: 1d20 + @{willpower} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{willpower}]] ]]}}"></button>
                </button>
              </div>
            </div>
          </div>
        </div>


      </div>

      <div class="sheet-col-right">
        <div class="sheet-noborder">
          <div class="sheet-thick-border">
            <h3>Skills</h3>
            <div class="sheet-bold-font">
              <input type="checkbox" class="sheet-skill-points-overspent" name="attr_skill_points_overspent" value="0" hidden="true" checked="true"/>

              <span>Skill Points Available: <input type="number" class="sheet-inactive-color" name="attr_skill_points" value="0" readonly="true"/></span>
              <span class="sheet-skill-points-overspend-notify">Skill Points Spent: <input type="number" class="sheet-inactive-color" name="attr_skill_points_used" value="0" readonly="true"/></span>
            </div>
            <div class="sheet-block">
              <div class="sheet-block">
                <div class="sheet-thin-border sheet-bottom-padding">
                  <h4>Core Skills</h4>
                  <div class="sheet-flex-between">
                    <div class="sheet-block sheet-side-padding">

                      <div class="sheet-block-between">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Arcana</span>
                          <input type="number" name="attr_arcana_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_arcana"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Arcana Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{arcana_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{arcana_skill}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block-between">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Architect</span>
                          <input type="number" name="attr_architect_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_architect"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Architect Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{architect_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{architect_skill}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block-between">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Armory</span>
                          <input type="number" name="attr_armory_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_armory"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Armory Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{armory_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{armory_skill}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Athletics</span>
                          <input type="hidden" name="attr_athletics_skill_mod" value="0"/>
                          <input type="number" name="attr_athletics_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_athletics"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Athletics Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{athletics_skill} + (@{athletics_skill_mod} STR/DEX mod)}} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{athletics_skill} + @{athletics_skill_mod}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Bushcraft</span>
                          <input type="number" name="attr_bushcraft_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_bushcraft"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Bushcraft Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{bushcraft_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{bushcraft_skill}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Languages</span>
                          <input type="number" name="attr_languages_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_languagues"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Languages Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{languages_skill} + (@{intelligence_mod} INT mod)}} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{languages_skill} + @{intelligence_mod}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Open&nbsp;Doors</span>
                          <input type="number" name="attr_open_door_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_opendoor"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Open Doors Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{open_door_skill} + (@{strength_mod} STR mod) }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{open_door_skill} + @{strength_mod}]] ]]}}"></button>
                        </div>
                      </div>
                    </div>

                    <div class="sheet-block sheet-side-padding">
                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Search</span>
                          <input type="number" name="attr_search_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_search"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Search Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{search_skill} + (@{intelligence_mod} INT mod)}} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{search_skill} + @{intelligence_mod}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Sleight of Hand</span>
                          <input type="number" name="attr_sleight_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_sleight"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Sleight of Hand Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{sleight_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{sleight_skill}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-left">
                          <span class="sheet-bold-font">&nbsp;&nbsp;&nbsp; Sneak&nbsp;Attack</span>
		                      <span>&nbsp;&nbsp;</span>
                          <input type="number" name="attr_sneak_attack_skill" class="sheet-skillvalue" value="0"/>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Stealth</span>
                          <input type="number" name="attr_stealth_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_stealth"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Stealth Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{stealth_skill} + (@{dexterity_mod} DEX mod) }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{stealth_skill} + @{dexterity_mod}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <input type="text" class="sheet-primary-skill-name" name="attr_social_skill_name" value="Social (Rename)"/>
                          <input type="number" name="attr_social_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_stealth"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{social_skill_name} Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{social_skill} + (@{charisma_mod} CHA mod)}} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{social_skill} + @{charisma_mod}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Theology</span>
                          <input type="number" name="attr_theology_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_theology"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Theology Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{theology_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{theology_skill}]] ]]}}"></button>
                        </div>
                      </div>

                      <div class="sheet-block">
                        <div class="sheet-align-right">
                          <span class="sheet-bold-font">Tinker</span>
                          <input type="number" name="attr_tinker_skill" class="sheet-skillvalue" value="0"/>
                          <button class="sheet-skill-button" type="roll" name="roll_tinker"
                                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=Tinker Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{tinker_skill} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{tinker_skill}]] ]]}}"></button>
                        </div>
                      </div>

                    </div>
                  </div>

                </div>
              </div>

              <div class="sheet-thin-border">
                <h4>Other Skills</h4>
                <fieldset class="repeating_skills">
                  <div class="sheet-block sheet-thin-border sheet-side-padding">
                    <div class="sheet-align-right">
                      <input type="text" name="attr_skillname" class="sheet-bottom-line sheet-skillname"/>
                      <input type="number" name="attr_skillvalue" class="sheet-skillvalue" value="1"/>
                      <button class="sheet-skill-button" type="roll" name="roll_skill"
                              value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{skillname} Check}} {{subheader=@{character_name}}} {{skill=1}} {{simple=1}} {{math=roll: 1d20 + @{skillvalue} }} {{noadvroll=1}} {{roll1=[[ 1d20 + [[@{skillvalue}]] ]]}}"></button>
                    </div>
                  </div>
               </fieldset>
             </div>
           </div>
         </div>

         <div class="sheet-inline">
           <div class="sheet-thick-border">
             <h3>Languages</h3>
             <div class="sheet-flex-between">
               <div class="sheet-col-right">
                 <h4>Known Languages</h4>
                 <textarea class="sheet-tiny-textarea" spellcheck="false" name="attr_known_lang" data-i18n-placeholder="known_lang"></textarea>
               </div>
               <div class="sheet-col-left">
                 <h4>Not Known Languages</h4>
                 <textarea class="sheet-tiny-textarea" spellcheck="false" name="attr_not_known_lang" data-i18n-placeholder="not_known_lang"></textarea>
               </div>
             </div>
           </div>
         </div>

        </div>
      </div>
    </div>
  </div>

  <div class="sheet-section-combat">
    <span class="sheet-spacer">&nbsp;</span>
    <div class="sheet-thick-border-no-pad">
      <h3>Combat</h3>
      <div class="sheet-flex left-pad bottom-padding">
        <div class="sheet-thin-border sheet-flex left-pad">
          <div class="sheet-ability-column-value">
            <input class="ability-check-value inactive-color" name="attr_initiative" type="number" value="0" readonly="true"/>
            <span class="ability-check-label">Initiative Bonus</span>
          </div>
          <div class="sheet-flex-between left-pad">
	    <button type="roll" class="sheet-initiative" name="roll_initiative"
			  value="&{template:roll_check} {{title=Initiative}} {{subheader=@{character_name}}} {{initiative=1}} {{rollname=Initiative}} {{roll=[[ 1d20 + @{initiative} [Initiative Mod] &{tracker} ]]}}">Roll Init.</button>
          </div>
        </div>
        <div class="sheet-ability-column-value">
          <input class="ability-check-value inactive-color" name="attr_ac" type="number" value="0" readonly="true"/>
          <span class="ability-check-label">AC</span>
        </div>
        <div class="sheet-ability-column-value">
          <input class="ability-check-value inactive-color" name="attr_melee_ab" type="number" value="0" readonly="true"/>
          <span class="ability-check-label">Melee AB</span>
        </div>
        <div class="sheet-ability-column-value">
          <input class="ability-check-value inactive-color" name="attr_ranged_ab" type="number" value="0" readonly="true"/>
          <span class="ability-check-label">Ranged AB</span>
        </div>
        <div class="sheet-ability-column-value">
          <input class="ability-check-value" name="attr_hit_points" type="number" value="1"/>
          <span class="ability-check-label">HP</span>
        </div>
      </div>
      <div class="sheet-thin-border">
        <div class="sheet-bottom-padding">
          <h4>Combat Options</h4>
        </div>
        <div class="sheet-flex-between">
          <div class="sheet-col-right">
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_stnd_attack" value="1" checked="checked" readonly="true"/>
              <span class="ability-check-label">Stnd</span>
              <span class="sheet-small-font sheet-italic-font sheet-flex-between">&nbsp;(AB+0 AC+0)</span>
            </div>
            <div class="sheet-bottom-padding">
              <div class="sheet-flex">
                &nbsp;&nbsp;
                <span class="ability-check-label">Parry</span>
              </div>
              <div class="sheet-flex">
                &nbsp;&nbsp;&nbsp;&nbsp;
                <span><input type="radio" class="inactive-color" name="attr_parry_attack" value="ac2" checked="checked" readonly="true"/>AC+2</span>
                <span><input type="radio" class="inactive-color" name="attr_parry_attack" value="ac4" readonly="true"/>AC+4</span>
              </div>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_press_attack" value="1" readonly="true"/>
              <span class="ability-check-label">Press</span>
              <span class="sheet-small-font sheet-italic-font sheet-flex-between">&nbsp;(AB+2 AC-4)</span>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_defensive_attack" value="1" readonly="true"/>
              <span class="ability-check-label">Defensive</span>
              <span class="sheet-small-font sheet-italic-font sheet-flex-between">&nbsp;(AB-4 AC+2)</span>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_beserk_attack" value="1"/>
              <span class="ability-check-label sheet-flex-between">Beserk</span>
              <span class="sheet-small-font sheet-italic-font sheet-flex-between">&nbsp;(AB +3+Fghtr/4, Dam +3+Fghtr/4, No Retreat, Will to Stop)</span>
            </div>
          </div>
          <div class="sheet-col-left">
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_cleave_attack" value="1"/>
              <span class="ability-check-label">Cleave</span>
              <span class="sheet-small-font sheet-italic-font sheet-flex-between">&nbsp;(AB/2 -&gt; Dam, Attack adj foe on kill, AC-2)</span>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_2weapon_attack" value="1"/>
              <span class="ability-check-label">2&nbsp;Weapon</span>
              <span class="sheet-small-font sheet-italic-font">&nbsp;(2nd Attk with offhand or AC+1)</span>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_rapid_strike_attack1" value="1"/>
              <input type="checkbox" name="attr_rapid_strike_attack2" value="1"/>
              <span class="ability-check-label">Rapid Strike</span>
              <span class="sheet-small-font sheet-italic-font">&nbsp;(Xtra Melee Attk, AC-4)</span>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_rapid_shot_attack1" value="1"/>
              <input type="checkbox" name="attr_rapid_shot_attack2" value="1"/>
              <span class="ability-check-label">Rapid Shot</span>
              <span class="sheet-small-font sheet-italic-font">&nbsp;(Xtra Ranged Attk, AC-4)</span>
            </div>
            <div class="sheet-flex sheet-bottom-padding">
              <input type="checkbox" name="attr_strong_attack" value="1"/>
              <span class="ability-check-label">Strong</span>
              <span class="sheet-small-font sheet-italic-font">&nbsp;(Dam x2, AC-2)</span>
            </div>
          </div>
          <div class="sheet-inline sheet-side-padding">
            <div class="sheet-flex sheet-side-padding">
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <input class="inactive-color" type="checkbox" name="attr_sneak_attack_checkbox" value="1" readonly="true"/>
                <span>Sneak Attack</span>
              </div>
              <div class="sheet-ability-column-modifier sheet-flex-between">
                <span class="sheet-italic-font">Extra Dam. Dice</span>
                <div class="sheet-flex">
                  <span><h2>+</h2></span>
                  <input class="ability-value sheet-inactive-color" name="attr_sneak_attack_dice" type="number" value="0" readonly="true"/>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sheet-thick-border">
      <h3>Weapons</h3>
      <div class="sheet-inline-flex">
        <input type="checkbox" class="sheet-beserk_attack_enabled" name="attr_beserk_attack_enabled" value="1" hidden="true"/>
        <input type="checkbox" class="sheet-cleave_attack_enabled" name="attr_cleave_attack_enabled" value="1" hidden="true"/>
        <input type="checkbox" class="sheet-defense_attack_enabled" name="attr_defense_attack_enabled" value="1" hidden="true"/>
        <input type="checkbox" class="sheet-press_attack_enabled" name="attr_press_attack_enabled" value="1" hidden="true"/>
        <input type="checkbox" class="sheet-sneak_attack_enabled" name="attr_sneak_attack_enabled" value="1" hidden="true"/>
        <input type="checkbox" class="sheet-strong_attack_enabled" name="attr_strong_attack_enabled" value="1" hidden="true"/>
        <input type="number" name="attr_beserk_attack_mod" value="2" hidden="true"/>

        <span class="sheet-weapon-param-name sheet-rotate sheet-bold-font sheet-italic-font">Notches</span>
        <span class="sheet-weapon-name sheet-bold-font">Name</span>
        <span class="sheet-weapon-param-name sheet-bold-font">Add. Bonus</span>
        <span class="sheet-weapon-param-select-name sheet-bold-font">Type</span>
        <span class="sheet-weapon-param-name sheet-bold-font">Attk Bonus</span>
        <span class="sheet-weapon-param-select-name sheet-bold-font">Damage</span>
        <span class="sheet-weapon-param-name sheet-bold-font">Dam Bonus</span>
        <span class="sheet-weapon-param-name sheet-bold-font">Stnd. Attack</span>

        <div class="sheet-press_attack_section">
          <span class="sheet-weapon-param-name sheet-bold-font">Press Attack</span>
        </div>
        <div class="sheet-defense_attack_section">
          <span class="sheet-weapon-param-name sheet-bold-font">Defns. Attack</span>
        </div>

        <div class="sheet-beserk_attack_section">
          <span class="sheet-weapon-param-name sheet-bold-font">Beserk Attack</span>
        </div>

        <div class="sheet-cleave_attack_section">
          <span class="sheet-weapon-param-name sheet-bold-font">Cleave Attack</span>
        </div>

        <div class="sheet-strong_attack_section">
          <span class="sheet-weapon-param-name sheet-bold-font">Strong Attack</span>
        </div>

        <div class="sheet-sneak_attack_section">
          <span class="sheet-weapon-param-name sheet-bold-font">Sneak Attack</span>
        </div>

      </div>
      <fieldset class="repeating_weapons">
        <div class="sheet-inline-flex">
          <input type="checkbox" class="sheet-weapon_beserk_attack_enabled" name="attr_weapon_beserk_attack_enabled" value="1" hidden="true"/>
          <input type="checkbox" class="sheet-weapon_cleave_attack_enabled" name="attr_weapon_cleave_attack_enabled" value="1" hidden="true"/>
          <input type="checkbox" class="sheet-weapon_defense_attack_enabled" name="attr_weapon_defense_attack_enabled" value="1" hidden="true"/>
          <input type="checkbox" class="sheet-weapon_press_attack_enabled" name="attr_weapon_press_attack_enabled" value="1" hidden="true"/>
          <input type="checkbox" class="sheet-weapon_strong_attack_enabled" name="attr_weapon_strong_attack_enabled" value="1" hidden="true"/>
          <input type="checkbox" class="sheet-weapon_sneak_attack_enabled" name="attr_weapon_sneak_attack_enabled" value="1" hidden="true"/>
          <input name="attr_weapon_sneak_attack_bonus" value="[[@{sneak_attack_skill}+[[@{weapon_bonus}]]-[[@{weapon_notches}]]]]" hidden="true"/>
          <input name="attr_weapon_sneak_attack_dam" value="0" hidden="true"/>

          <select class="sheet-weapon-notches" name="attr_weapon_notches">
            <option selected="selected" value="0">--</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
          <input type="text" name="attr_weapon_name" class="weapon-name" data-i18n-placeholder="name"/>

          <input type="number" name="attr_weapon_bonus" class="weapon-param sheet-purple-border" value="0"/>

  	      <select class="weapon-param" name="attr_weapon_type">
  	        <option selected="selected" value="@{melee_ab}">Melee</option>
  	        <option value="@{ranged_ab}">Ranged</option>
  	      </select>

          <input type="number" name="attr_weapon_attack_bonus" class="weapon-param inactive-color" value="[[@{weapon_type}+[[@{weapon_bonus}]]-[[@{weapon_notches}]]]]" disabled="true"/>
          <!--input type="number" name="attr_weapon_sneak_attack_bonus" value="[[@{sneak_attack_skill}+[[@{weapon_bonus}]]-[[@{weapon_notches}]] ]]" hidden="true"/-->

          <select class="sheet-weapon-param" name="attr_weapon_dam_die">
            <option selected="selected" value="1d2">1d2</option>
            <option value="1d4">1d4</option>
            <option value="1d6">1d6</option>
            <option value="1d8">1d8</option>
            <option value="1d10">1d10</option>
            <option value="1d12">1d12</option>
            <option value="2d4">2d4</option>
            <option value="2d6">2d6</option>
            <option value="2d8">2d8</option>
          </select>
          <input name="attr_weapon_dam" value="0" hidden="true"/>

          <input type="number" name="attr_weapon_dam_bonus" class="weapon-param inactive-color" value="[[@{strength_mod}+[[@{weapon_bonus}]]]]" disabled="true"/>

          <button class="sheet-attack-button sheet-red-border" type="roll" name="roll_weapon_attack"
                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} Attack}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_attack_bonus}]] ]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] ]]}} {{math=1d20 + [[@{weapon_attack_bonus}]] [Attack], @{weapon_dam} + @{weapon_dam_bonus} [Damage] }}"></button>

          <div class="sheet-weapon_press_attack_section">
            <button class="sheet-attack-button sheet-red-border" type="roll" name="roll_press_attack"
                    value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} <b>Press Attack</b>}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_attack_bonus}]] + 2 ]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] ]]}} {{math=1d20 + [[@{weapon_attack_bonus}]] + 2 [Attack], @{weapon_dam} + @{weapon_dam_bonus} [Damage] }}"></button>
          </div>
          <div class="sheet-weapon_defense_attack_section">
            <button class="sheet-attack-button sheet-red-border" type="roll" name="roll_defense_attack"
                    value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} <b>Defensive Attack</b>}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_attack_bonus}]] - 4]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] ]]}} {{math=1d20 + [[@{weapon_attack_bonus}]] -4 [Attack], @{weapon_dam} + @{weapon_dam_bonus} [Damage] }}"></button>
          </div>

          <div class="sheet-weapon_beserk_attack_section">
            <button class="sheet-attack-button sheet-yellow-border" type="roll" name="roll_beserk_attack"
	                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} <b>Beserk Attack</b>}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_attack_bonus}]] + [[@{beserk_attack_mod}]] ]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] + [[@{beserk_attack_mod}]] ]]}} {{math=1d20 + [[@{weapon_attack_bonus}]] + @{beserk_attack_mod} [Attk], @{weapon_dam} + @{weapon_dam_bonus} + @{beserk_attack_mod} [Dam] }}"></button>
          </div>

          <div class="sheet-weapon_cleave_attack_section">
            <button class="sheet-attack-button sheet-blue-border" type="roll" name="roll_cleave_attack"
	                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} <b>Cleave Attack</b>}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_bonus}]] ]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] + [[@{weapon_attack_bonus}/2]]  ]]}} {{math=1d20 + [[@{weapon_bonus}]] [Attack], @{weapon_dam} + @{weapon_dam_bonus} + [[@{weapon_attack_bonus}/2]] [Dam] }}"></button>
          </div>

          <div class="sheet-weapon_strong_attack_section">
            <button class="sheet-attack-button sheet-green-border" type="roll" name="roll_strong_attack"
                    value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} <b> Strong Attack</b>}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_attack_bonus}]] ]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] + [[@{weapon_dam}]] + [[@{weapon_dam_bonus}]] ]]}} {{math=1d20 + [[@{weapon_attack_bonus}]] [Attack], @{weapon_dam} + @{weapon_dam_bonus} + @{weapon_dam} + @{weapon_dam_bonus} [Dam] }}"></button>
          </div>

          <div class="sheet-weapon_sneak_attack_section">
            <button class="sheet-attack-button sheet-orange-border" type="roll" name="roll_sneak_attack"
	                  value="&{template:roll_check} {{character_name=@{character_name}}} {{title=@{weapon_name} <b>Sneak Attack</b>}} {{subheader=@{character_name}}} {{weapon=1}} {{attack=[[ 1d20 + [[@{weapon_sneak_attack_bonus}]]]]}} {{simple=1}} {{damage=[[@{weapon_dam} + [[@{weapon_dam_bonus}]] + [[@{weapon_sneak_attack_dam}]] ]]}} {{math=1d20 + @{weapon_sneak_attack_bonus} [Attack], @{weapon_dam} + @{weapon_dam_bonus} + @{weapon_sneak_attack_dam} [Dam] }}"></button>
          </div>

        </div>
      </fieldset>
    </div>
  </div>

  <div class="sheet-section-magic">
    <span class="sheet-spacer">&nbsp;</span>
    <div class="sheet-thick-border">
    <h3>Magic</h3>
      <div class="sheet-thin-border">
        <h4>Spellcasting</h4>
        <div class="sheet-flex-between">
          <div class="sheet-flex-between sheet-center">
            <div class="sheet-ability-column-modifier sheet-flex-between sheet-side-padding">
               <span>Spellcasting Type</span>
            </div>
            <input class="ability-value sheet-inactive-color sheet-align-left sheet-info4" name="attr_spellcasting_type" type="text" value="None" readonly="true"/>
            <!--
            <select class="sheet-info4" name="attr_spellcasting_type">
              <option selected="selected" value="none">Pick Type</option>
              <option value="arcane">Wizard</option>
              <option value="divine">Cleric</option>
            </select>
            -->
          </div>

          <div class="sheet-flex">
            <div class="sheet-ability-column-modifier sheet-flex-between sheet-side-padding">
              <span>Spellcasting Modifier</span>
            </div>
            <div class="sheet-ability-column-modifier sheet-flex-between">
              <div class="sheet-thin-border sheet-flex sheet-side-padding">
                <span><h2>+</h2></span>
                <input class="ability-value sheet-inactive-color" name="attr_spellcasting_mod" type="number" value="0" readonly="true"/>
              </div>
            </div>
          </div>
          <div class="sheet-flex">
            <div class="sheet-ability-column-modifier sheet-flex-between sheet-side-padding">
              <span>Spell Save DC</span>
            </div>
            <div class="sheet-ability-column-modifier sheet-flex-between">
              <div class="sheet-thin-border sheet-flex sheet-side-padding">
                <input class="ability-value sheet-inactive-color" name="attr_spellcasting_dc" type="number" value="0" readonly="true"/>
              </div>
            </div>
          </div>
        </div>
      </div>

      <span class="sheet-spacer">&nbsp;</span>

      <div class="sheet-thin-border sheet-bottom-padding">
        <h4>Powers</h4>
        <div class="sheet-flex-between">
          <div class="sheet-flex-between sheet-thin-border">
            <div class="sheet-col-left sheet-inline">
              <input type="checkbox" name="attr_turn_undead1" value="1"/>
              <input type="checkbox" name="attr_turn_undead2" value="1"/>
              <input type="checkbox" name="attr_turn_undead3" value="1"/>
              <span class="sheet-small-font sheet-italic-font">&nbsp;(per day)</span>
            </div>
            <div class="sheet-col-right">
              <span class="sheet-bold-font">Turn Undead</span>
            </div>
          </div>
          <div class="sheet-flex-between sheet-bottom-padding sheet-thin-border">
            <div class="sheet-col-left sheet-inline">
              <input type="checkbox" name="attr_dispel_magic1" value="1"/>
              <input type="checkbox" name="attr_dispel_magic2" value="1"/>
              <span class="sheet-small-font sheet-italic-font">&nbsp;(per day)</span>
            </div>
            <div class="sheet-col-right">
              <span class="sheet-bold-font">Dispel Magic</span>
            </div>
          </div>
          <div class="sheet-flex-between sheet-bottom-padding sheet-thin-border">
            <div class="sheet-col-left sheet-inline">
              <input type="checkbox" name="attr_dispel_evil" value="1"/>
              &nbsp;
              <span class="sheet-small-font sheet-italic-font">&nbsp;(per day)</span>
            </div>
            <div class="sheet-col-right">
              <span class="sheet-bold-font">Dispel Evil</span>
            </div>
          </div>
        </div>
      </div>

      <span class="sheet-spacer">&nbsp;</span>

      <div class="sheet-thin-border sheet-spells">
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="all" checked/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="1"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="2"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="3"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="4"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="5"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="6"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="7"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="8"/>
          <input type="checkbox" name="attr_spells_filter" class="sheet-spellfilter" value="9"/>
          <h4>Spellbook</h4>

          <div class="sheet-spells-per-level sheet-flex">
            <div class="sheet-flex">
              <span class="sheet-italic-font sheet-side-padding">Slots / Level</span>
            </div>
            <div class="sheet-flex">
              <span>1:</span>
                <input type="number" name="attr_spells_l1" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>2:</span>
                <input type="number" name="attr_spells_l2" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>3:</span>
                <input type="number" name="attr_spells_l3" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>4:</span>
                <input type="number" name="attr_spells_l4" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>5:</span>
                <input type="number" name="attr_spells_l5" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>6:</span>
                <input type="number" name="attr_spells_l6" value="0"/>
            </div>
                <div class="sheet-flex">
                <span>7:</span>
                <input type="number" name="attr_spells_l7" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>8:</span>
                <input type="number" name="attr_spells_l8" value="0"/>
            </div>
            <div class="sheet-flex">
                <span>9:</span>
                <input type="number" name="attr_spells_l9" value="0"/>
            </div>
          </div>

          <div class="sheet-spell-filters sheet-flex-between">
           <span class="sheet-bold-font">Filter:</span>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="all" checked/>
               <span data-i18n="all"></span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="1"/>
               <span>1</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="2"/>
               <span>2</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="3"/>
               <span>3</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="4"/>
               <span>4</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="5"/>
               <span>5</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="6"/>
               <span>6</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="7"/>
               <span>7</span>
           </label>
           <label class="sheet-filter-button">
               <input type="radio" name="attr_spells_filter" value="8"/>
               <span>8</span>
           </label>
           <label class="sheet-filter-button">
             <input type="radio" name="attr_spells_filter" value="9"/>
             <span>9</span>
           </label>
         </div>

         <fieldset class="repeating_spells">
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="1"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="2"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="3"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="4"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="5"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="6"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="7"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="8"/>
           <input type="checkbox" name="attr_spelllevel" class="sheet-hidden-spell-level" value="9"/>
           <div class="sheet-spellcontainer sheet-side-padding">
             <input type="text" name="attr_spellname" class="sheet-bottom-line sheet-spell-name" data-i18n-placeholder="name"/>
             <span class="sheet-left-pad"> Level:</span>
             <select class="sheet-info1 sheet-align-right sheet-spell-level" name="attr_spelllevel">
               <option selected="selected" value="1">1</option>
               <option value="2">2</option>
               <option value="3">3</option>
               <option value="4">4</option>
               <option value="5">5</option>
               <option value="6">6</option>
               <option value="7">7</option>
               <option value="8">8</option>
               <option value="9">9</option>
             </select>
	     <button class="sheet-attack-button" type="roll" name="roll_cast_spell"
							     value="&{template:roll_check}  {{character_name=@{character_name}}} {{title=Cast @{spellname}}} {{subheader=@{character_name}}} {{spell=1}} {{level=@{spelllevel}}} {{description=@{spelldescription}}}"></button>
             <textarea spellcheck="false" name="attr_spelldescription" class="sheet-spell-description" data-i18n-placeholder="description"></textarea>
           </div>
         </fieldset>
      </div>
    </div>
  </div>

  <div class="sheet-section-inventory">
    <span class="sheet-spacer">&nbsp;</span>
      <div class="sheet-block">
        <div class="sheet-flex-between sheet-bottom-padding">
          <div class="sheet-thin-border sheet-padding">
            <span class="sheet-bold-font sheet-left-pad">Encumbrance Points:</span>
            <input type="number" name="attr_encumbrance_points" class="sheet-inactive-color" value="0" readonly="true"/>
            <span class="sheet-bold-font">Encumbrance Modifier:</span>
            <input type="number" name="attr_encumbrance_mod" class="sheet-inactive-color" value="0" readonly="true"/>
            <span class="sheet-bold-font sheet-big-font">Encumbrance: </span>
            <input type="number" name="attr_encumbrance" class="sheet-inactive-color sheet-right-pad" value="0" readonly="true"/>
          </div>
          <div class="sheet-thin-border sheet-padding">
            <span class="sheet-bold-font sheet-big-font">Movement Rate: </span>
            <input type="number" name="attr_movement_rate" class="sheet-inactive-color" value="0" readonly="true"/>
          </div>
        </div>
        <div class="sheet-thick-border">
        <h3>Inventory</h3>
        <div class="sheet-flex-between">
          <div class="sheet-col-left-inv">
            <div class="sheet-thin-border sheet-padding">
              <div class="table sheet-fill-width">
                <div class="table-row sheet-inline-flex">
                  <div class="table-cell sheet-table-cell">
                    <span class="sheet-bold-font">Armor:</span>
                  </div>
                  <div class="table-cell sheet-table-cell">
                    <select name="attr_armor" class="sheet-armor-name">
                      <option selected="selected" value="none">Clothing / 0 Slots</option>
                      <option value="leather">Leather / 1 Slot</option>
                      <option value="studded_leather">Std. Leather / 1 Slot</option>
                      <option value="chain">Chain / 1 Enc. Pts. / 1 Slot</option>
                      <option value="plate">Plate / 2 Enc. Pts. / 1 Slot</option>
                    </select>
                  </div>
                  <div class="table-cell sheet-table-cell">
                    <div class="sheet-block">
                      <select class="sheet-weapon-notches" name="attr_armor_notches">
                        <option selected="selected" value="0">--</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                      </select>
                      <span class="sheet-italic-font">Notches</span>
                    </div>
                  </div>
                </div>
		            <div class="table-row sheet-flex-simple">
                  <div class="table-cell sheet-table-cell">
                    <span class="sheet-bold-font">Shield:</span>
                  </div>
                  <div class="table-cell sheet-table-cell">
                    <select name="attr_shield" class="sheet-armor-name">
                      <option selected="selected" value="none">None / 0 Slots</option>
                      <option value="small_shield">Small Shield / 1 Slot</option>
                      <option value="large_shield">Large Shield / 2 Slots</option>
                      <option value="tower_shield">Tower Shield / 2 Slots/1 Enc</option>
                    </select>
                  </div>
                  <div class="table-cell sheet-table-cell">
                    <div class="sheet-block">
                      <select class="sheet-weapon-notches" name="attr_shield_notches">
                        <option selected="selected" value="0">--</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                      </select>
                      <span class="sheet-italic-font">Notches</span>
                    </div>
                  </div>
                </div>
                <div class="table-row sheet-flex-simple">
                  <div class="table-cell sheet-table-cell">
                    <div class="sheet-block">
                      <span class="sheet-center">Armor Bonus:</span>
                    </div>
                  </div>
                  <div class="table-cell sheet-table-cell sheet-bottom-pad">
                    <input type="number" class="center sheet-purple-border" name="attr_armor_bonus" value="0"/>
                  </div>
                  <div class="table-cell sheet-table-cell">
                      <span class="sheet-center sheet-left-pad">Shield Bonus:</span>
                  </div>
                  <div class="table-cell sheet-table-cell sheet-bottom-pad">
                      <input type="number" class="center sheet-purple-border" name="attr_shield_bonus" value="0"/>
                  </div>
                </div>
              </div>
            </div>
            <div class="sheet-thin-border sheet-padding">
              <h3>Ready Items</h3>
              <div class="table sheet-fill-width">
                <input class="sheet-dex-show-slots" name="attr_dex-show-slots" type="hidden" value="18"/>
                <div class="table-row sheet-flex-simple">
                  <div class="table-cell sheet-table-header-cell sheet-item-name"><span>Item Name</span></div>
                  <div class="table-cell sheet-table-header-cell sheet-item-dex">Min Dex.</div>
                </div>
                <div class="table-row sheet-table-sep-row"></div>
                <div class="table-row sheet-flex-simple">
                  <div class="table-cell sheet-table-cell"><input name="attr_islot3-1" type="text" class="sheet-item-name" value="" data-i18n-placeholder="Primary Hand"/></div>
                  <div class="table-cell sheet-table-cell"><input type="number" value="3" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                </div>
                <div class="sheet-dex4slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input name="attr_islot4-1" type="text" class="sheet-item-name" data-i18n-placeholder="Off Hand"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="4" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-no-dex4slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input name="attr_islot4-2" type="text" class="sheet-item-name sheet-inactive-color" data-i18n-placeholder="Off Hand" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="4" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-dex6slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input name="attr_islot6-1" type="text" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="6" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input name="attr_islot6-2" type="text" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="6" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input name="attr_islot6-3" type="text" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="6" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-no-dex6slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="6" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="6" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="6" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="table-row sheet-table-sep-row"></div>
                <div class="sheet-dex9slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-9-1" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-9-2" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-9-3" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-9-4" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-9-5" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-no-dex9slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="9" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="table-row sheet-table-sep-row"></div>
                <div class="table-row sheet-table-sep-row"></div>
                <div class="sheet-dex13slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-13-1" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-13-2" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-13-3" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-13-4" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-13-5" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-no-dex13slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="13" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="table-row sheet-table-sep-row"></div>
                <div class="sheet-dex16slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-16-1" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-16-2" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-16-3" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-16-4" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-16-5" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-no-dex16slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="16" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="table-row sheet-table-sep-row"></div>
                <div class="sheet-dex18slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-18-1" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-18-2" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-18-3" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-18-4" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" name="attr_islot-18-5" class="sheet-item-name"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="sheet-no-dex18slots">
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                  <div class="table-row sheet-flex-simple">
                    <div class="table-cell sheet-table-cell"><input type="text" value="" class="sheet-item-name sheet-inactive-color" readonly="true"/></div>
                    <div class="table-cell sheet-table-cell"><input type="number" value="18" class="sheet-inactive-color sheet-item-dex" readonly="true"/></div>
                  </div>
                </div>
                <div class="table-row sheet-table-sep-row"></div>
              </div>
            </div>
          </div>
          <div class="sheet-col-right-inv">
            <div class="sheet-thin-border sheet-bottom-padding">
              <h3>Purse (Coins/Gems)</h3>
              <textarea class="sheet-sm-textarea" spellcheck="false" name="attr_purse_items" data-i18n-placeholder="coins_gems"></textarea>
            </div>
            <div class="sheet-padding"></div>
            <div class="sheet-flex-between">
              <div class="sheet-col-right sheet-padding">
                <div class="sheet-thin-border sheet-padding">
                  <div class="table sheet-fill-width">
                    <div class="table-row sheet-flex-simple">
                      <div class="table-cell sheet-table-header-cell"><span>Container 1 </span></div>
                      <div class="table-cell sheet-table-header-cell">
                        <select name="attr_container_1_type" class="sheet-info5">
                          <option selected="selected" value="none">None</option>
                          <option value="sack">Sack</option>
                          <option value="small_pack">Small Pack</option>
                          <option value="large_pack">Large Pack - 1 Enc. Pt.</option>
                        </select>
                      </div>
                    </div>
                    <input class="sheet-cont1-show-slots" name="attr_cont1_show_slots" type="hidden" value="none"/>
                    <div class="table-row sheet-table-sep-row"></div>
                    <div class="sheet-sack1-slots">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-1" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-2" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-3" type="text" class="sheet-container-item"/></div>
                      </div>
                    </div>
                    <div class="sheet-no-sack1-slots">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                    </div>
                    <div class="sheet-sm-pack1-slots">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-4" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-5" type="text" class="sheet-container-item"/></div>
                      </div>
                    </div>
                    <div class="sheet-no-sm-pack1-slots">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                    </div>
                    <div class="sheet-lrg-pack-slots">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-6" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-7" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-8" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-9" type="text" class="sheet-container-item"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input name="attr_cslot1-10" type="text" class="sheet-container-item"/></div>
                      </div>
                    </div>
                    <div class="sheet-no-lrg-pack-slots">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="sheet-padding"></div>
              <div class="sheet-col-left sheet-padding">
                <div class="sheet-block">
                  <div class="sheet-thin-border sheet-padding">
                    <div class="table sheet-fill-width">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-header-cell"><span>Container 2 </span></div>
                        <div class="table-cell sheet-table-header-cell">
                          <select name="attr_container_2_type" class="sheet-info5">
                            <option selected="selected" value="none">None</option>
                            <option value="sack">Sack</option>
                            <option value="small_pack">Small Pack - 1 Enc. Pt.</option>
                          </select>
                        </div>
                      </div>
                      <input class="sheet-cont2-show-slots" name="attr_cont2_show_slots" type="hidden" value="none"/>
                      <div class="table-row sheet-table-sep-row"></div>
                      <div class="sheet-sack2-slots">
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot2-1" type="text" class="sheet-container-item"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot2-2" type="text" class="sheet-container-item"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot2-3" type="text" class="sheet-container-item"/></div>
                        </div>
                      </div>
                      <div class="sheet-no-sack2-slots">
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                      </div>
                      <div class="sheet-sm-pack2-slots">
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot2-4" type="text" class="sheet-container-item"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot2-5" type="text" class="sheet-container-item"/></div>
                        </div>
                      </div>
                      <div class="sheet-no-sm-pack2-slots">
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                      </div>
                      <div class="table-row sheet-table-sep-row"></div>
                    </div>
                  </div>
                  <div class="sheet-padding"></div>
                  <div class="sheet-thin-border sheet-padding">
                    <div class="table sheet-fill-width">
                      <div class="table-row sheet-flex-simple">
                        <div class="table-cell sheet-table-header-cell"><span>Container 3 </span></div>
                        <div class="table-cell sheet-table-header-cell">
                          <select name="attr_container_3_type" class="sheet-info5">
                            <option selected="selected" value="none">None</option>
                            <option value="sack">Sack - 1 Enc. Pt.</option>
                          </select>
                        </div>
                      </div>
                      <input class="sheet-cont3-show-slots" name="attr_cont3_show_slots" type="hidden" value="none"/>
                      <div class="table-row sheet-table-sep-row"></div>
                      <div class="sheet-sack3-slots">
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot3-1" type="text" class="sheet-container-item"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot3-2" type="text" class="sheet-container-item"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input name="attr_cslot3-3" type="text" class="sheet-container-item"/></div>
                        </div>
                      </div>
                      <div class="sheet-no-sack3-slots">
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                        <div class="table-row sheet-flex-simple">
                          <div class="table-cell sheet-table-cell"><input type="text" class="sheet-container-item sheet-inactive-color" readonly="true"/></div>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
            <div class="sheet-padding"></div>
            <div class="sheet-thin-border sheet-bottom-padding">
              <h3>Non-Encumbering Items</h3>
              <textarea class="sheet-med-textarea" spellcheck="false" name="attr_non_encumber_items" data-i18n-placeholder="non_encumber_items"></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="sheet-section-notes">
    <span class="sheet-spacer">&nbsp;</span>
    <div class="sheet-thick-border">
      <h3>Notes</h3>
      <textarea class="sheet-lrg-textarea" spellcheck="false" name="attr_notes" data-i18n-placeholder="notes"></textarea>
    </div>
  </div>
  </div>
</div>

<!-- Templates -->
<rolltemplate class="sheet-rolltemplate-roll_check">
  <div class="sheet-rt-card">
	  <div class="sheet-rt-header{{#weapon}} sheet-weapon{{/weapon}}{{#skill}} sheet-skill{{/skill}} {{#initiative}} sheet-initiative{{/initiative}}{{#spell}} sheet-spell{{/spell}}{{#ability}} sheet-ability{{/ability}}{{#save}} sheet-save{{/save}}{{#deathsave}} sheet-deathsave{{/deathsave}}">
      <div class="sheet-rt-title">{{title}}</div>
      {{#subheader}}
      <div class="sheet-rt-subheader">{{subheader}}{{#subheaderright}} &bullet; {{subheaderright}}{{/subheaderright}}</div>
      {{/subheader}} {{#subheader2}}
      <div class="sheet-rt-subheader">{{subheader2}}{{#subheaderright2}} &bullet; {{subheaderright2}}{{/subheaderright2}}</div>
      {{/subheader2}}
    </div>
    {{#emote}}
    <p class="sheet-rt-emote">{{character_name}} {{emote}}</p>
    {{/emote}}
    <div class="sheet-main-content">
        <!--Weapon based attacks-->
        {{#attack}}
        <div class="sheet-row">
                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Attack</div>
                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{attack}}{{#attackadv}} | {{attackadv}}{{/attackadv}} vs AC</div>
        </div>
        {{/attack}} {{#damage}}
        <div class="sheet-row">
                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{damage}}</div>
        </div>
        {{/damage}} {{#rollWasCrit() attack}}
        <div class="sheet-row">
                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{critdamage}}</div>
        </div>
        {{/rollWasCrit() attack}} {{#rollWasCrit() attackadv}}
        <div class="sheet-row">
                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit (adv roll)</div>
                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{critdamage}} (if attack was made with advantage)</div>
        </div>
        {{/rollWasCrit() attackadv}}
        <!--Generic section-->
        {{#freetext}}
        <div class="sheet-row">
                <div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-key-wide">{{freetextname}}</div>
                <div class="sheet-col-1 sheet-padl sheet-padr sheet-rt-value">{{freetext}}</div>
        </div>
        {{/freetext}} {{#roll}}
        <div class="sheet-row">
                <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{rollname}}</div>
                <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll}}{{#rolladv}} | {{rolladv}}{{/rolladv}}</div>
        </div>
        {{/roll}}
        <!-- START roll option templates -->
        <!--Simple roll (such as save/skill check or weapon attack)-->
        {{#simple}} {{#rollhasadv}}
        <div class="sheet-row">
               <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Roll type</div>
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">With advantage</div>
        </div>
        {{/rollhasadv}} {{#rollhasdisadv}}
        <div class="sheet-row">
               <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Roll type</div>
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">With disadvantage</div>
        </div>
        {{/rollhasdisadv}}
        <div class="sheet-row">
               <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">{{rollname}}</div>
               {{#noadvroll}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll1}}</div>
               {{/noadvroll}} {{#showadvroll}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll1}} | {{roll2}}</div>
               {{/showadvroll}} {{#rollhasadv}} {{#rollTotal() roll1 roll2}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll1}} | <span class="sheet-ignored-roll">{{roll2}}</span></div>{{/rollTotal() roll1 roll2}} {{#rollGreater() roll1 roll2}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll1}} | <span class="sheet-ignored-roll">{{roll2}}</span></div>{{/rollGreater() roll1 roll2}} {{#rollGreater() roll2 roll1}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value"><span class="sheet-ignored-roll">{{roll1}}</span> | {{roll2}}</div>{{/rollGreater() roll2 roll1}} {{/rollhasadv}} {{#rollhasdisadv}} {{#rollTotal() roll1 roll2}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll1}} | <span class="sheet-ignored-roll">{{roll2}}</span></div>{{/rollTotal() roll1 roll2}} {{#rollLess() roll1 roll2}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{roll1}} | <span class="sheet-ignored-roll">{{roll2}}</span></div>{{/rollLess() roll1 roll2}} {{#rollLess() roll2 roll1}}
               <div class="sheet-col-7-12 sheet-padr sheet-rt-value"><span class="sheet-ignored-roll">{{roll1}}</span> | {{roll2}}</div>{{/rollLess() roll2 roll1}} {{/rollhasdisadv}}
        </div>
        {{#weapondamage}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Damage</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weapondamage}}</div>
        </div>
        {{/weapondamage}} {{#weapon}} {{#noadvroll}} {{#rollWasCrit() roll1}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll1}} {{/noadvroll}} {{#showadvroll}} {{#rollWasCrit() roll1}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll1}} {{#rollWasCrit() roll2}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit (adv roll)</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll2}} {{/showadvroll}} {{#rollhasadv}} {{#rollGreater() roll1 roll2}} {{#rollWasCrit() roll1}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll1}} {{/rollGreater() roll1 roll2}} {{#rollGreater() roll2 roll1}} {{#rollWasCrit() roll2}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll2}} {{/rollGreater() roll2 roll1}} {{#rollTotal() roll1 roll2}} {{#rollWasCrit() roll1}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll1}} {{/rollTotal() roll1 roll2}} {{/rollhasadv}} {{#rollhasdisadv}} {{#rollLess() roll1 roll2}} {{#rollWasCrit() roll1}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll1}} {{/rollLess() roll1 roll2}} {{#rollLess() roll2 roll1}} {{#rollWasCrit() roll2}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll2}} {{/rollLess() roll2 roll1}} {{#rollTotal() roll1 roll2}} {{#rollWasCrit() roll1}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Crit</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value">{{weaponcritdamage}}</div>
        </div>
        {{/rollWasCrit() roll1}} {{/rollTotal() roll1 roll2}} {{/rollhasdisadv}} {{/weapon}} {{#math}}
        <div class="sheet-row">
                 <div class="sheet-col-5-12 sheet-padl sheet-padr sheet-rt-key">Math</div>
                 <div class="sheet-col-7-12 sheet-padr sheet-rt-value sheet-no-roll-highlight">{{math}}</div>
        </div>
        {{/math}} {{/simple}}
        <!-- END roll option templates -->
    </div>
  </div>
</rolltemplate>

<!-- Sheet Workers -->
<script type="text/worker">

  // container update
  on(`change:container_1_type change:container_2_type change:container_3_type`, () => {
    getAttrs(['container_1_type', 'container_2_type', 'container_3_type'], v=> {
       setAttrs( {cont1_show_slots: v.container_1_type,
                  cont2_show_slots: v.container_2_type,
                  cont3_show_slots: v.container_3_type});
    });

  });

  // Ability modifiers
  const raceMods = { Human: "", Dwarf: "constitution", Halfling: "dexterity", Elven : "charisma:intelligence:dexterity" };
  ['charisma', 'constitution', 'dexterity', 'intelligence', 'strength', 'wisdom'].forEach( ability => {
    on(`sheet:opened change:class change:class2 change:race change:level change:level2 change:${ability}`, () => {
          getAttrs([ability, 'class', 'class2', 'race', 'level', 'level2', 'skill_points'], v => {
              const setting = {};
              const score = parseInt(v[ability]) || 10;
              const statrank = [1,3,5,8,12,15,17,19].findIndex(rank => score <= rank);
              const level = parseInt(v.level) || 0;
              const level2 = parseInt(v.level2) || 0;
              const race = v.race.trim();
              const c_class = v.class.trim();
              const c_class2 = v.class2.trim();
              const ability_mod = `${ability}_mod`
              setting[ability_mod] = (statrank === -1 ? 4 : statrank -4) + ((raceMods[race] || '').indexOf(ability) !== -1 ? 1 : 0);

              // intelligence based stuff
              if (ability === 'intelligence') {
                const base_int_mod = setting[ability_mod];

                // skill points
                // starting race skills; elves dont get any skill points to start
                var base_race_start_skills = (race === 'Elven' ? 0 : 3) + base_int_mod;
                if (base_race_start_skills < 0) {
                  // prevent negative totals
                  base_race_start_skills = 0;
                }

                // class skills
                const base_start_class_skills = (level > 0 ? ((c_class === 'specialist' ?  8 : 3) + base_int_mod) : 0); // set by the first class chosen at 1st level

                // class skills for levels beyond 1st
                const class1_skill_points = (base_int_mod + (c_class === 'specialist' ?  3 : 1)) * (level - 1);
                const class2_skill_points = (base_int_mod + (c_class2 === 'specialist' ?  3 : 1)) * level2;

                var class_skill_points = class1_skill_points + class2_skill_points;
                if (class_skill_points < 0) {
                  // prevent negative totals
                  class_skill_points = 0;
                }

                setting["skill_points"] = base_start_class_skills + base_race_start_skills + class_skill_points;

                // arcane spellcasting
                if (c_class === 'wizard') {
                  setting["spellcasting_mod"] = base_int_mod + parseInt(level/3);
                  setting["spellcasting_dc"] = base_int_mod + 10 + parseInt(level/3);
                }
                else
                if (c_class2 === 'wizard') {
                  setting["spellcasting_mod"] = base_int_mod + parseInt(level2/3);
                  setting["spellcasting_dc"] = base_int_mod + 10 + parseInt(level2/3);
                }

              }

              if (ability === 'wisdom') {

                const base_wis_mod = setting[ability_mod];

                // divine spell casting
                if (c_class === 'cleric') {
                  setting["spellcasting_mod"] = base_wis_mod + parseInt(level/3);
                  setting["spellcasting_dc"] = base_wis_mod + 10 + parseInt(level/3);
                }
                else
                if (c_class2 === 'cleric') {
                  setting["spellcasting_mod"] = base_wis_mod + parseInt(level2/3);
                  setting["spellcasting_dc"] = base_wis_mod + 10 + parseInt(level2/3);
                }

              }

              // do dex-based stuff
              if (ability === 'dexterity') {
                const base_dex_mod = setting[ability_mod];
                setting["initiative"] = base_dex_mod;
                setting["ranged_ab"] = base_dex_mod + 1 + (c_class === 'fighter' ? level : (c_class2 === 'fighter' ? level2 : 0));

                // for ready inventory slots
                setting["dex-show-slots"] = score;
              }

              if (ability === 'strength') {
                const base_str_mod = setting[ability_mod]
                setting["melee_ab"] = base_str_mod + 1 + (c_class === 'fighter' ? level : (c_class2 === 'fighter' ? level2 : 0));
                setting["encumbrance_mod"] = base_str_mod + (race === 'Dwarf' ? 1 : 0);
              }

              setAttrs(setting);
            });
        });
      });

  // determine which attribute contributes the bonus for Athletics skill
  on(`change:strength_mod change:dexterity_mod`, () => {
    getAttrs(['strength_mod', 'dexterity_mod', 'athletics_skill_mod'], v => {
      const str_mod = parseInt(v.strength_mod);
      const dex_mod = parseInt(v.dexterity_mod);
      if (str_mod > dex_mod) {
        setAttrs({athletics_skill_mod: str_mod})
      } else {
        setAttrs({athletics_skill_mod: dex_mod})
      }
    });
  });

  // update ability modifiers
  const abilityCheck = { strength_mod: "fortitude", dexterity_mod: "dodge", constitution_mod: "health", intelligence_mod: "perception", wisdom_mod: "willpower" };
  ['charisma_mod', 'constitution_mod', 'dexterity_mod', 'intelligence_mod', 'strength_mod', 'wisdom_mod'].forEach(ability_mod => {
    on(`sheet:opened change:level change:level2 change:${ability_mod}`, () => {
      getAttrs([ability_mod, 'level', 'level2'], v => {
        const setting = {};
        const score = parseInt(v[ability_mod]) || 0;
        const level = parseInt(v.level) || 1;
        const level2 = parseInt(v.level2) || 0;

        const checkName = abilityCheck[ability_mod];
        setting[checkName] = score + parseInt((level+level2)/2);

        setAttrs(setting);
      });
    });
  });

  // Calculate armor class
  const armor_ac_value = {'none': 0, 'leather': 2, 'studded_leather': 4, 'chain': 6, 'plate': 8};
  const shield_ac_value = {'none': 0, 'small_shield': 1, 'large_shield': 2, 'tower_shield': 3};
  on(`sheet:opened change:armor change:shield change:dexterity_mod change:armor_bonus change:armor_notches change:shield_bonus change:shield_notches`, () => {
    getAttrs(['armor', 'shield', 'armor_bonus', 'armor_notches', 'shield_bonus', 'shield_notches', 'dexterity_mod'], v => {
      var armor_class = 10 + parseInt(v.dexterity_mod)
      armor_class += parseInt(armor_ac_value[v.armor]) + parseInt(shield_ac_value[v.shield]) - parseInt(v.armor_notches) - parseInt(v.shield_notches)
      armor_class += parseInt(v.armor_bonus) + parseInt(v.shield_bonus);
      setAttrs({ac : armor_class});
    });
  });

  // General Class/Level stuff
  on(`sheet:opened change:class change:class2 change:level change:level2 change:race change:xp`, () => {
    getAttrs(['class', 'class2', 'level', 'level2', 'alignment', 'race', 'xp'], v => {
      const c_align = v.alignment.trim();
      const c_class = v.class.trim();
      const c_class2 = v.class2.trim();
      const c_race = v.race.trim();
      const level = parseInt(v.level) || 0;
      const level2 = parseInt(v.level2) || 0;
      const xp = parseInt(v.xp) || 0;

      const is_cleric = (c_class === 'cleric' || c_class2 === 'cleric');
      const is_fighter = (c_class === 'fighter' || c_class2 === 'fighter');
      const is_specialist = (c_class === 'specialist' || c_class2 === 'specialist');
      const is_wizard = (c_class === 'wizard' || c_class2 === 'wizard');

      const setting = {};

      // calculate next level xp
      const next_level_xp = level < 1 ? 100 : 1000 * (2**(level + level2 - 1));
      setting['next_level_xp'] = next_level_xp;
      setting['next_level_up'] = next_level_xp <= xp ? 0 : 1;

      // deal with sneak attack stuff
      setting['sneak_attack_enabled'] = (c_class === 'specialist' ? 1 : (c_class2 === 'specialist' ? 1: 0));
      setting['sneak_attack_checkbox'] = (c_class === 'specialist' ? 1 : (c_class2 === 'specialist' ? 1: 0));
      setting['sneak_attack_dice'] = (c_class === 'specialist' ?  1 + parseInt(level/4): (c_class2 === 'specialist' ?  1 + parseInt(level2/4): 0));

      if (is_wizard)
      {
        setting["spellcasting_type"] = "Arcane";
        setting["alignment"] = "Chaotic";
      }
      else
      if (is_cleric)
      {
        setting["spellcasting_type"] = "Divine";
        setting["alignment"] = "Lawful";
      }
      else
      {
        setting["spellcasting_type"] = "None";
        setting["spellcasting_mod"] = 0;
        setting["spellcasting_dc"] = 0;
        setting["alignment"] = c_align;
      }

      // force alignment if Wizard, Cleric or Elven
      if (c_race === 'Elven') {
        setting["alignment"] = "Chaotic";
      }

      setting['press_attack'] = is_fighter ? 1 : 0;
      setting['defensive_attack'] = is_fighter ? 1 : 0;
      setting['parry_attack'] = is_fighter ? 1 : 0;

      if (c_class === 'fighter')
      {
        setting['beserk_attack_mod'] = 3 + parseInt(level/4)
      }
      else
      if (c_class2 === 'fighter')
      {
        setting['beserk_attack_mod'] = 3 + parseInt(level2/4)
      }
      else
      {
        setting['beserk_attack_mod'] = 0;
      }

      setAttrs(setting);
    });
  });

  const coreSkills = ['arcana_skill', 'architect_skill', 'armory_skill', 'athletics_skill', 'bushcraft_skill',
                      'languages_skill', 'open_door_skill', 'search_skill', 'sleight_skill', 'sneak_attack_skill',
                      'stealth_skill', 'social_skill', 'theology_skill', 'tinker_skill'];

  coreSkills.forEach(core_skill => {
    on(`change:${core_skill} change:repeating_skills remove:repeating_skills`, () => {
      // find total skill points spent
       var skill_point_total = 0;

       // find core skills value total
       getAttrs(coreSkills, v => {
          skill_point_total = Object.values(v).reduce((m, w) => (m + (parseInt(w) || 0)), 0);
          setAttrs({skill_points_used: skill_point_total});
       });

       // now look at additional (repeating_skills) skills
       const other_skills = [];
       getSectionIDs('repeating_skills', function (ids) {
         ids.forEach(id => {
           other_skills.push('repeating_skills_' + id + '_skillvalue');
         });

         //getAttrs(coreSkills, v => {
         //getAttrs([...other_skills, ...coreSkills], v => {
         getAttrs([...other_skills, 'skill_points', 'skill_points_used'], v => {
           var skill_points_available = parseInt(v['skill_points']);
           var skill_point_total = parseInt(v['skill_points_used']);
           ids.forEach( id => {
             const skill_value = parseInt(v['repeating_skills_' + id + '_skillvalue']);
             skill_point_total += skill_value;
           });

           const overspent = (skill_point_total > skill_points_available ? 0 : 1);

           // update
           setAttrs({skill_points_used: skill_point_total, skill_points_overspent: overspent});
         });
       });

    });
  });

  // Keep weapons up to date
  const combatOpts = ['press_attack', 'defensive_attack', 'beserk_attack', 'cleave_attack', 'strong_attack' ];

  combatOpts.forEach(combat_opt => {
    on(`change:${combat_opt} change:sneak_attack_dice change:repeating_weapons change:level change:level2` , function () {
      getSectionIDs('repeating_weapons', function (ids) {
        const fieldnames = [];
        ids.forEach(id => {
              fieldnames.push('repeating_weapons_' + id + '_weapon_sneak_attack_dam');
              fieldnames.push('repeating_weapons_' + id + '_weapon_dam_die');
              fieldnames.push('repeating_weapons_' + id + '_weapon_notches');
          });
          getAttrs([...fieldnames, ...combatOpts, 'sneak_attack_dice'], function (values) {
              const output = {};

              const sneak_dice = parseInt(values.sneak_attack_dice) || 0;
              const beserk_attack = parseInt(values.beserk_attack) || 0;
              const cleave_attack = parseInt(values.cleave_attack) || 0;
              const defensive_attack = parseInt(values.defensive_attack) || 0;
              const press_attack = parseInt(values.press_attack) || 0;
              const strong_attack = parseInt(values.strong_attack) || 0;

              output['beserk_attack_enabled'] = beserk_attack;
              output['cleave_attack_enabled'] = cleave_attack;
              output['defense_attack_enabled'] = defensive_attack;
              output['press_attack_enabled'] = press_attack;
              output['strong_attack_enabled'] = strong_attack;

              ids.forEach(id => {

                  const weapon_dam_die = values['repeating_weapons_' + id + '_weapon_dam_die'];
                  const weapon_notches = parseInt(values['repeating_weapons_' + id + '_weapon_notches']);

                  const num_dam_die = parseInt(weapon_dam_die.substring(0,1));
                  const weapon_dam_die_type = parseInt(weapon_dam_die.substring(2)) - (2 * (weapon_notches));

                  // safety for low die weapons with lots of notches
                  if (weapon_dam_die_type < 0) {
                    weapon_dam_die_type = 0;
                  }

                  // final calculations
                  const sneak_dam = (sneak_dice * num_dam_die ) + 'd' + weapon_dam_die_type;
                  const weapon_dam = num_dam_die + 'd' + weapon_dam_die_type;

                  // apply new properties to weapon
                  output['repeating_weapons_' + id + '_weapon_beserk_attack_enabled'] = beserk_attack;
                  output['repeating_weapons_' + id + '_weapon_cleave_attack_enabled'] = cleave_attack;
                  output['repeating_weapons_' + id + '_weapon_defense_attack_enabled'] = defensive_attack;
                  output['repeating_weapons_' + id + '_weapon_press_attack_enabled'] = press_attack;
                  output['repeating_weapons_' + id + '_weapon_strong_attack_enabled'] = strong_attack;
                  output['repeating_weapons_' + id + '_weapon_sneak_attack_dam'] = sneak_dam;
                  output['repeating_weapons_' + id + '_weapon_sneak_attack_enabled'] = sneak_dice > 0 ? 1 : 0;
                  output['repeating_weapons_' + id + '_weapon_dam'] = weapon_dam;

              });
              setAttrs(output);
          });
      });
    });
  });

  const armor_enc = { 'chain' : 1, 'plate': 2 }
  const shield_enc = { 'tower_shield' : 1 }

  // Check various inventory slots and the encumberance
  const islots9  = [ 'islot-9-1', 'islot-9-2', 'islot-9-3', 'islot-9-4', 'islot-9-5'];
  const islots13 = [ 'islot-13-1', 'islot-13-2', 'islot-13-3', 'islot-13-4', 'islot-13-5'];
  const islots16 = [ 'islot-16-1', 'islot-16-2', 'islot-16-3', 'islot-16-4', 'islot-16-5'];
  const islots18 = [ 'islot-18-1', 'islot-18-2', 'islot-18-3', 'islot-18-4', 'islot-18-5'];
  const readySlots = islots9.concat(islots13.concat(islots16.concat(islots18)));

  readySlots.forEach(ready_slot => {
    on(`change:${ready_slot} change:race change:encumbrance_mod change:armor change:shield change:container_1_type change:container_2_type change:container_3_type`, () => {
      getAttrs(readySlots.concat(['encumbrance_mod', 'race', 'armor', 'shield', 'container_1_type',
                                  'container_2_type', 'container_3_type']), v => {
        // ugh. seems like there should be a better way to do this
        const enc_points9 = islots9.reduce((m, w) => (m + (v[w] !== "" ? 1 : 0 )), 0) > 0 ? 1 : 0;
        const enc_points13 = islots13.reduce((m, w) => (m + (v[w] !== "" ? 1 : 0 )), 0) > 0 ? 1 : 0;
        const enc_points16 = islots16.reduce((m, w) => (m + (v[w] !== "" ? 1 : 0 )), 0) > 0 ? 1 : 0;
        const enc_points18 = islots18.reduce((m, w) => (m + (v[w] !== "" ? 1 : 0 )), 0) > 0 ? 1 : 0;

        // Containers
        const container_1_enc_pts = v.container_1_type === 'large_pack' ? 1 : 0;
        const container_2_enc_pts = v.container_2_type === 'small_pack' ? 1 : 0;
        const container_3_enc_pts = v.container_3_type === 'sack' ? 1 : 0;

        // armor
        const armor_enc_pts = armor_enc[v.armor] || 0;
        const shield_enc_pts = shield_enc[v.shield] || 0;

        // calculate encumbrance points
        const enc_points = enc_points9 + enc_points13 + enc_points16 + enc_points18
                           + container_1_enc_pts + container_2_enc_pts + container_3_enc_pts
                           + armor_enc_pts + shield_enc_pts;

        // calculate encumbrance
        var enc = enc_points - parseInt(v['encumbrance_mod']);
        enc = enc > 0 ? enc : 0;

        // TODO: Calculate movement
        const enc_move_factor = enc > 1 ? enc : 0;
        var move_rate = (v.race === 'Dwarf' || v.race === 'Halfling') ? 35 : 40;
        move_rate -= enc_move_factor > 0 ? (enc_move_factor -1) * 10 : 0;
        move_rate = move_rate > 0 ? move_rate : 0;

        setAttrs( { encumbrance_points: enc_points, encumbrance: enc, movement_rate: move_rate} );
      });
    });
  });

  on(`change:is_multiclass`, () => {
    getAttrs(['is_multiclass'], v=> {
       setAttrs( {multiclass_enabled: v.is_multiclass });
    });
  });

</script>
